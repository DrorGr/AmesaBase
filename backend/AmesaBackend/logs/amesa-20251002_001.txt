2025-10-02 14:22:16.235 +03:00 [INF] Lottery draw service running...
2025-10-02 14:22:16.517 +03:00 [INF] Notification background service running...
2025-10-02 14:23:14.029 +03:00 [INF] Notification background service running...
2025-10-02 14:24:14.031 +03:00 [INF] Notification background service running...
2025-10-02 14:25:14.038 +03:00 [INF] Notification background service running...
2025-10-02 14:26:14.051 +03:00 [INF] Notification background service running...
2025-10-02 14:27:13.748 +03:00 [INF] Lottery draw service running...
2025-10-02 14:27:14.058 +03:00 [INF] Notification background service running...
2025-10-02 14:28:14.061 +03:00 [INF] Notification background service running...
2025-10-02 14:29:14.064 +03:00 [INF] Notification background service running...
2025-10-02 14:30:14.076 +03:00 [INF] Notification background service running...
2025-10-02 14:31:14.086 +03:00 [INF] Notification background service running...
2025-10-02 14:32:13.762 +03:00 [INF] Lottery draw service running...
2025-10-02 14:32:14.089 +03:00 [INF] Notification background service running...
2025-10-02 14:33:14.095 +03:00 [INF] Notification background service running...
2025-10-02 14:34:14.107 +03:00 [INF] Notification background service running...
2025-10-02 14:35:14.119 +03:00 [INF] Notification background service running...
2025-10-02 14:36:14.126 +03:00 [INF] Notification background service running...
2025-10-02 14:37:14.508 +03:00 [INF] Notification background service running...
2025-10-02 14:37:14.509 +03:00 [INF] Lottery draw service running...
2025-10-02 14:38:14.522 +03:00 [INF] Notification background service running...
2025-10-02 14:39:14.525 +03:00 [INF] Notification background service running...
2025-10-02 14:40:14.527 +03:00 [INF] Notification background service running...
2025-10-02 14:41:14.534 +03:00 [INF] Notification background service running...
2025-10-02 14:42:14.524 +03:00 [INF] Lottery draw service running...
2025-10-02 14:42:14.540 +03:00 [INF] Notification background service running...
2025-10-02 14:43:14.551 +03:00 [INF] Notification background service running...
2025-10-02 14:44:14.555 +03:00 [INF] Notification background service running...
2025-10-02 14:45:14.565 +03:00 [INF] Notification background service running...
2025-10-02 14:46:14.567 +03:00 [INF] Notification background service running...
2025-10-02 14:47:14.531 +03:00 [INF] Lottery draw service running...
2025-10-02 14:47:14.573 +03:00 [INF] Notification background service running...
2025-10-02 14:48:14.582 +03:00 [INF] Notification background service running...
2025-10-02 14:49:14.583 +03:00 [INF] Notification background service running...
2025-10-02 14:50:14.597 +03:00 [INF] Notification background service running...
2025-10-02 14:51:14.612 +03:00 [INF] Notification background service running...
2025-10-02 14:52:14.541 +03:00 [INF] Lottery draw service running...
2025-10-02 14:52:14.616 +03:00 [INF] Notification background service running...
2025-10-02 14:53:14.620 +03:00 [INF] Notification background service running...
2025-10-02 14:54:14.619 +03:00 [INF] Notification background service running...
2025-10-02 14:55:14.627 +03:00 [INF] Notification background service running...
2025-10-02 14:56:14.632 +03:00 [INF] Notification background service running...
2025-10-02 14:57:14.554 +03:00 [INF] Lottery draw service running...
2025-10-02 14:57:14.639 +03:00 [INF] Notification background service running...
2025-10-02 14:58:14.651 +03:00 [INF] Notification background service running...
2025-10-02 14:59:14.652 +03:00 [INF] Notification background service running...
2025-10-02 15:00:14.653 +03:00 [INF] Notification background service running...
2025-10-02 15:01:14.669 +03:00 [INF] Notification background service running...
2025-10-02 15:02:14.569 +03:00 [INF] Lottery draw service running...
2025-10-02 15:02:14.676 +03:00 [INF] Notification background service running...
2025-10-02 15:03:14.679 +03:00 [INF] Notification background service running...
2025-10-02 15:04:14.686 +03:00 [INF] Notification background service running...
2025-10-02 15:05:14.695 +03:00 [INF] Notification background service running...
2025-10-02 15:06:14.700 +03:00 [INF] Notification background service running...
2025-10-02 15:07:14.576 +03:00 [INF] Lottery draw service running...
2025-10-02 15:07:14.701 +03:00 [INF] Notification background service running...
2025-10-02 15:08:14.709 +03:00 [INF] Notification background service running...
2025-10-02 15:09:14.724 +03:00 [INF] Notification background service running...
2025-10-02 15:10:14.731 +03:00 [INF] Notification background service running...
2025-10-02 15:11:14.734 +03:00 [INF] Notification background service running...
2025-10-02 15:12:14.583 +03:00 [INF] Lottery draw service running...
2025-10-02 15:12:14.739 +03:00 [INF] Notification background service running...
2025-10-02 15:13:14.744 +03:00 [INF] Notification background service running...
2025-10-02 15:14:14.753 +03:00 [INF] Notification background service running...
2025-10-02 15:15:14.755 +03:00 [INF] Notification background service running...
2025-10-02 15:16:14.762 +03:00 [INF] Notification background service running...
2025-10-02 15:17:14.587 +03:00 [INF] Lottery draw service running...
2025-10-02 15:17:14.774 +03:00 [INF] Notification background service running...
2025-10-02 15:18:14.774 +03:00 [INF] Notification background service running...
2025-10-02 15:19:14.778 +03:00 [INF] Notification background service running...
2025-10-02 15:20:14.787 +03:00 [INF] Notification background service running...
2025-10-02 15:21:14.789 +03:00 [INF] Notification background service running...
2025-10-02 15:22:14.597 +03:00 [INF] Lottery draw service running...
2025-10-02 15:22:14.798 +03:00 [INF] Notification background service running...
2025-10-02 15:23:14.805 +03:00 [INF] Notification background service running...
2025-10-02 15:24:14.810 +03:00 [INF] Notification background service running...
2025-10-02 15:25:14.817 +03:00 [INF] Notification background service running...
2025-10-02 15:26:14.826 +03:00 [INF] Notification background service running...
2025-10-02 15:27:14.608 +03:00 [INF] Lottery draw service running...
2025-10-02 15:27:14.840 +03:00 [INF] Notification background service running...
2025-10-02 15:28:14.848 +03:00 [INF] Notification background service running...
2025-10-02 15:29:14.859 +03:00 [INF] Notification background service running...
2025-10-02 15:30:14.865 +03:00 [INF] Notification background service running...
2025-10-02 15:31:14.867 +03:00 [INF] Notification background service running...
2025-10-02 15:32:14.612 +03:00 [INF] Lottery draw service running...
2025-10-02 15:32:14.870 +03:00 [INF] Notification background service running...
2025-10-02 15:33:14.885 +03:00 [INF] Notification background service running...
2025-10-02 15:34:14.897 +03:00 [INF] Notification background service running...
2025-10-02 15:35:14.898 +03:00 [INF] Notification background service running...
2025-10-02 15:36:14.904 +03:00 [INF] Notification background service running...
[2025-10-02 15:36:54.544 +03:00 WRN] The foreign key property 'LotteryDraw.HouseId1' was created in shadow state because a conflicting property with the simple name 'HouseId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core. {"EventId":{"Id":10625,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.ShadowForeignKeyPropertyCreated"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
[2025-10-02 15:36:54.580 +03:00 WRN] The foreign key property 'LotteryTicket.HouseId1' was created in shadow state because a conflicting property with the simple name 'HouseId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core. {"EventId":{"Id":10625,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.ShadowForeignKeyPropertyCreated"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
[2025-10-02 15:36:54.580 +03:00 WRN] The foreign key property 'LotteryTicket.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core. {"EventId":{"Id":10625,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.ShadowForeignKeyPropertyCreated"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
[2025-10-02 15:36:54.581 +03:00 WRN] The foreign key property 'Transaction.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core. {"EventId":{"Id":10625,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.ShadowForeignKeyPropertyCreated"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
[2025-10-02 15:36:54.581 +03:00 WRN] The foreign key property 'UserAddress.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core. {"EventId":{"Id":10625,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.ShadowForeignKeyPropertyCreated"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
[2025-10-02 15:36:54.581 +03:00 WRN] The foreign key property 'UserNotification.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core. {"EventId":{"Id":10625,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.ShadowForeignKeyPropertyCreated"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
[2025-10-02 15:36:54.581 +03:00 WRN] The foreign key property 'UserPaymentMethod.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core. {"EventId":{"Id":10625,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.ShadowForeignKeyPropertyCreated"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
[2025-10-02 15:36:54.581 +03:00 WRN] The foreign key property 'UserPhone.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core. {"EventId":{"Id":10625,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.ShadowForeignKeyPropertyCreated"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
[2025-10-02 15:36:54.581 +03:00 WRN] The foreign key property 'UserPromotion.PromotionId1' was created in shadow state because a conflicting property with the simple name 'PromotionId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core. {"EventId":{"Id":10625,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.ShadowForeignKeyPropertyCreated"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
[2025-10-02 15:36:54.581 +03:00 WRN] The foreign key property 'UserPromotion.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core. {"EventId":{"Id":10625,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.ShadowForeignKeyPropertyCreated"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
[2025-10-02 15:36:54.581 +03:00 WRN] The foreign key property 'UserSession.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core. {"EventId":{"Id":10625,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.ShadowForeignKeyPropertyCreated"},"SourceContext":"Microsoft.EntityFrameworkCore.Model.Validation"}
[2025-10-02 15:36:54.963 +03:00 INF] Database setup and seeding completed successfully {}
[2025-10-02 15:36:54.964 +03:00 INF] Starting Amesa Lottery API {}
[2025-10-02 15:36:54.993 +03:00 INF] Lottery draw service running... {"SourceContext":"AmesaBackend.Services.LotteryDrawService"}
[2025-10-02 15:36:54.995 +03:00 INF] Notification background service running... {"SourceContext":"AmesaBackend.Services.NotificationBackgroundService"}
[2025-10-02 15:37:30.571 +03:00 INF] Request afbde5f6 started: GET /api/v1/houses from ::1 {"SourceContext":"AmesaBackend.Middleware.RequestLoggingMiddleware","RequestPath":"/api/v1/houses","ConnectionId":"0HNG1M1PVS1S8"}
[2025-10-02 15:37:31.035 +03:00 INF] Request afbde5f6 completed: GET /api/v1/houses - 200 in 468ms {"SourceContext":"AmesaBackend.Middleware.RequestLoggingMiddleware","RequestPath":"/api/v1/houses","ConnectionId":"0HNG1M1PVS1S8"}
[2025-10-02 15:37:31.071 +03:00 INF] Request f9680811 started: GET /api/v1/translations/en from ::1 {"SourceContext":"AmesaBackend.Middleware.RequestLoggingMiddleware","RequestPath":"/api/v1/translations/en","ConnectionId":"0HNG1M1PVS1S8"}
[2025-10-02 15:37:31.145 +03:00 INF] Request f9680811 completed: GET /api/v1/translations/en - 200 in 74ms {"SourceContext":"AmesaBackend.Middleware.RequestLoggingMiddleware","RequestPath":"/api/v1/translations/en","ConnectionId":"0HNG1M1PVS1S8"}
[2025-10-02 15:37:54.998 +03:00 INF] Notification background service running... {"SourceContext":"AmesaBackend.Services.NotificationBackgroundService"}
[2025-10-02 15:37:56.192 +03:00 INF] Request 8ae0fa8e started: GET /api/v1/lotteryresults from ::1 {"SourceContext":"AmesaBackend.Middleware.RequestLoggingMiddleware","RequestPath":"/api/v1/lotteryresults","ConnectionId":"0HNG1M1PVS1S9"}
[2025-10-02 15:37:56.231 +03:00 ERR] Failed executing DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "lottery_results" AS "l" {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"25cb7229-6359-4dd8-bcbe-489c599d3c25","ActionName":"AmesaBackend.Controllers.LotteryResultsController.GetLotteryResults (AmesaBackend)","RequestId":"0HNG1M1PVS1S9:00000001","RequestPath":"/api/v1/lotteryresults","ConnectionId":"0HNG1M1PVS1S9"}
[2025-10-02 15:37:56.240 +03:00 ERR] An exception occurred while iterating over the results of a query for context type 'AmesaBackend.Data.AmesaDbContext'.
Microsoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 1: 'no such table: lottery_results'.
   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)
   at Microsoft.Data.Sqlite.SqliteCommand.PrepareAndEnumerateStatements()+MoveNext()
   at Microsoft.Data.Sqlite.SqliteCommand.GetStatements()+MoveNext()
   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync() {"EventId":{"Id":10100,"Name":"Microsoft.EntityFrameworkCore.Query.QueryIterationFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Query","ActionId":"25cb7229-6359-4dd8-bcbe-489c599d3c25","ActionName":"AmesaBackend.Controllers.LotteryResultsController.GetLotteryResults (AmesaBackend)","RequestId":"0HNG1M1PVS1S9:00000001","RequestPath":"/api/v1/lotteryresults","ConnectionId":"0HNG1M1PVS1S9"}
Microsoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 1: 'no such table: lottery_results'.
   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)
   at Microsoft.Data.Sqlite.SqliteCommand.PrepareAndEnumerateStatements()+MoveNext()
   at Microsoft.Data.Sqlite.SqliteCommand.GetStatements()+MoveNext()
   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
[2025-10-02 15:37:56.243 +03:00 ERR] Error retrieving lottery results {"SourceContext":"AmesaBackend.Controllers.LotteryResultsController","ActionId":"25cb7229-6359-4dd8-bcbe-489c599d3c25","ActionName":"AmesaBackend.Controllers.LotteryResultsController.GetLotteryResults (AmesaBackend)","RequestId":"0HNG1M1PVS1S9:00000001","RequestPath":"/api/v1/lotteryresults","ConnectionId":"0HNG1M1PVS1S9"}
Microsoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 1: 'no such table: lottery_results'.
   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)
   at Microsoft.Data.Sqlite.SqliteCommand.PrepareAndEnumerateStatements()+MoveNext()
   at Microsoft.Data.Sqlite.SqliteCommand.GetStatements()+MoveNext()
   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at AmesaBackend.Controllers.LotteryResultsController.GetLotteryResults(LotteryResultsFilterDto filter) in C:\Users\dror0\Curser-Repos\AmesaBase\backend\AmesaBackend\Controllers\LotteryResultsController.cs:line 78
[2025-10-02 15:37:56.252 +03:00 INF] Request 8ae0fa8e completed: GET /api/v1/lotteryresults - 500 in 59ms {"SourceContext":"AmesaBackend.Middleware.RequestLoggingMiddleware","RequestPath":"/api/v1/lotteryresults","ConnectionId":"0HNG1M1PVS1S9"}
